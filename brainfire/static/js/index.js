// Generated by CoffeeScript 1.3.3
(function() {
  var Chirp,
    _this = this;

  Chirp = Chirp || {};

  (function($, chirp) {
    return chirp.fetchTweets = function(user, count, renderCallback) {
      var searchParams, url;
      url = "http://search.twitter.com/search.json";
      searchParams = {
        q: "from:" + user,
        rpp: count,
        result_type: "mixed"
      };
      return $.ajax({
        url: url,
        type: "GET",
        data: searchParams,
        dataType: "jsonp",
        success: function(search) {
          return renderCallback(search.results);
        }
      });
    };
  })(jQuery, Chirp);

  $(function() {
    return Chirp.fetchTweets('madzak', 3, function(tweets) {
      var tweet, _i, _len, _results;
      _results = [];
      for (_i = 0, _len = tweets.length; _i < _len; _i++) {
        tweet = tweets[_i];
        _results.push((function(tweet) {
          var DAY, d1, d2, days_passed;
          DAY = 1000 * 60 * 60 * 24;
          d1 = new Date(tweet.created_at);
          d2 = new Date;
          days_passed = Math.round((d2.getTime() - d1.getTime()) / DAY);
          return $('#tweet-list').append($("<dd class='tweet'><p>" + tweet.text + "</p><p class='right'>" + days_passed + " days ago</p></dd>"));
        })(tweet));
      }
      return _results;
    });
  });

}).call(this);
